{
  "name": "phase_2_investment_analysis",
  "description": "Phase 2 Investment Analysis",
  "hashver": "a9db",
  "commands": [
    "task_result",
    "complete_subtask",
    "execute_command",
    "mkdir",
    "append",
    "write",
    "read",
    "dir",
    "think"
  ],
  "preferred_providers": [],
  "thinking_level": "off",
  "persona": "Assistant",
  "recommended_plugins": [],
  "instructions": "# Phase 2: Financial Analysis & Mathematical Modeling\n\nThis phase performs comprehensive financial analysis using Python tools and custom calculations as appropriate. Document key findings in `analysis.md` to provide the mathematical foundation for investment recommendations and demonstrate reasonable investigation for regulatory compliance. \n\n## File Size and Running Python Code\n\nDo not attempt to run python in a single command. Rather, first write() the python code to a file and then execute it.\nThere is a limit to the size of output possible at once. \nIf the file is longer than 500 lines, write() the first chunk and then use append() for more chunks.\nThis goes for all files, not just Python.\n\nThere is a utility module in /xfiles/soa/soa_financial_utils.py. Read this in first. You can use it if it some of it applies.\n\nWhile doing the analysis, do NOT move on to the next step until you have receive the result from the system of your command executions with\nscript output and completed your analysis of that part.\n\n## Scope of Work\n\nTarget the most likely scenarios and key alternatives. Focus on material differences that impact client outcomes. Note: you do not need to implement the full strategy here -- the strategy is the next step!! But try to do calculations that can support strategy decisions.\n\nNote: if the client data has specific types of investment advice listed, do not make assumptions about their needs and add extra requirements! If they do not specify or seem open, that's different and you can help them. If you feel there is something important they are missing, mention it very briefly but only and don't do extra non-requested analysis.\n\n## Checklist\n\n- [ ] Read in inputs\n\n    Read the inputs.md file. Do NOT read in the other files as they have been compressed to inputs.md.\n\n- [ ] Calculate Tax Position and Cash Flow Analysis\n\n    Determine client's marginal tax rate including Medicare levy. Calculate monthly and annual surplus available for investment. Assess affordability of different contribution levels and impact on lifestyle. Use `calculate_marginal_tax_rate()` or custom calculations as appropriate. Document key assumptions and methodology.\n\n- [ ] Perform Goal-Based Financial Planning\n\n    Calculate required savings for retirement and other goals using compound interest formulas. Model education funding needs if applicable. Assess emergency fund adequacy. Consider using `required_monthly_savings()` and `retirement_adequacy_analysis()` or develop custom models for complex scenarios. Document material alternative scenarios only when they significantly impact recommendations.\n\n- [ ] Analyze Current Investment Portfolio\n\n    Calculate current asset allocation percentages across asset classes. Analyze existing investment fees and performance against benchmarks. Identify concentration risks or allocation gaps. Use utility functions where helpful or perform custom analysis for unique situations. Focus on material issues affecting recommendations.\n\n- [ ] Model Superannuation Contribution Benefits*\n\n    Test different contribution scenarios and calculate tax savings, net cost, and effective rates. Consider contribution caps, timing strategies, and carry-forward rules. The `super_contribution_benefit()` function provides a starting point, but customize for complex situations. Document key contribution strategies and their material differences.\n\n- [ ] Generate Investment Growth Projections\n\n    Model conservative, moderate, and growth scenarios with different return assumptions. Show impact of various monthly contribution amounts over the investment timeframe. Use `future_value()` or develop custom projections for specific client needs. Document key assumptions and sensitivity to major variables.\n\n- [ ] Calculate Fee Impact Analysis\n\n    Compare high-fee vs low-fee investment options over relevant time periods to demonstrate cost impact of different approaches. Calculate total cost of ownership including platform fees. Use `fee_impact_comparison()` where applicable or create custom analysis for complex fee structures. Focus on material cost differences.\n\n- [ ] Perform Market Risk Scenario Analysis\n\n    Model impact of market decline scenarios relevant to client's risk tolerance and timeframe. Calculate recovery periods and assess client's capacity for volatility. Use `market_downturn_analysis()` or develop scenario-specific models. Document key risk scenarios and client capacity assessment.\n\n- [ ] Compare Implementation Strategies\n\n    Analyze lump sum vs dollar-cost averaging for significant amounts. Calculate break-even timeframes for switching investments. Model tax implications of portfolio changes. Use utility functions where helpful or custom analysis for complex situations. Document material implementation alternatives.\n\n- [ ] Document Analysis Results\n\n    Create comprehensive `analysis.md` file in client directory with all calculations, assumptions, and findings. Include clear statement of mathematical analysis methodology and key data sources. Document material alternatives considered where they impact recommendations. Focus on demonstrating reasonable investigation rather than exhaustive documentation.\n\n## Task Result\n\nYour task result should simply be a list of absolute file paths output.\n\n\n---\n\n## Python Tools Available\n\n### **Utility Functions (use when appropriate)**\n- `calculate_marginal_tax_rate(annual_income)`\n- `future_value(present_value, annual_rate, years, monthly_contribution)`\n- `required_monthly_savings(target_amount, years, annual_return, current_savings)`\n- `super_contribution_benefit(contribution_amount, marginal_tax_rate)`\n- `fee_impact_comparison(investment_amount, years, product1, product2)`\n- `market_downturn_analysis(portfolio_value, downturn_percentage, recovery_years, annual_return)`\n- `retirement_adequacy_analysis(current_age, retirement_age, current_super, annual_contribution, annual_return, desired_income)`\n- `break_even_analysis(switching_cost, annual_saving)`\n\n### **Custom Analysis Considerations**\n- Complex tax situations may require custom calculations\n- Unique investment goals may need specialized modeling\n- Multiple scenarios may require iterative analysis\n- Client-specific constraints may need tailored approaches\n\n## Analysis.md Structure\n\n```markdown\n# Financial Analysis - [Client Name]\n\n## Executive Summary\n[Key findings and recommendations preview]\n\n## Tax and Cash Flow Analysis\n### Current Tax Position\n- Marginal tax rate: [%]\n- Annual investment capacity: $[amount]\n\n### Cash Flow Modeling\n[Analysis of surplus and investment affordability]\n\n## Goal-Based Planning\n### Retirement Adequacy\n[Current trajectory vs target with required savings]\n\n### Other Goals\n[Education, property, etc. with funding requirements]\n\n## Current Portfolio Analysis\n### Asset Allocation\n[Current vs optimal allocation analysis]\n\n### Fee Analysis\n[Current fees and optimization opportunities]\n\n## Superannuation Strategy\n[Key contribution scenarios with tax benefits]\n\n## Growth Projections\n[Multiple scenarios with different assumptions]\n\n## Risk Analysis\n[Market scenarios and client capacity]\n\n## Implementation Analysis\n[Strategy comparison and timing considerations]\n\n## Key Assumptions and Methodology\n[Document calculation methods, data sources, and material alternatives considered]\n\n## Supporting Calculations\n[Include key calculation results and methodology for verification]\n```\n\n## Key Considerations\n\n### **Analytical Focus**\n- Use utility functions where they fit the client situation\n- Develop custom analysis for unique circumstances\n- Combine multiple approaches for comprehensive analysis\n- Document rationale for key analytical choices\n\n### **Compliance Documentation**\n- Show key assumptions clearly\n- Include data sources and methodology\n- Provide sensitivity analysis for material variables\n- Keep calculations reproducible and verifiable\n- Document reasonable investigation process\n\n### **Materiality Guidelines**\n- Document alternatives when they materially impact recommendations\n- Focus on differences that affect client outcomes\n- Avoid documenting obviously inappropriate alternatives\n- Emphasize analysis that supports recommendation rationale\n\n## Key Outputs from Phase 2\n\n- Comprehensive `analysis.md` file demonstrating thorough investigation\n- Client's marginal tax rate and investment capacity\n- Retirement adequacy assessment with required savings\n- Current portfolio analysis with optimization opportunities\n- Superannuation contribution scenarios with tax benefits\n- Growth projections under different assumptions\n- Fee impact analysis demonstrating cost differences\n- Market risk scenario outcomes\n- Implementation strategy comparisons\n- Supporting calculations for verification and compliance\n- Documentation of reasonable investigation process\n",
  "technicalInstructions": "",
  "service_models": {
    "stream_chat": {
      "provider": "ah_openrouter",
      "model": "anthropic/claude-sonnet-4"
    }
  },
  "flags": [],
  "required_plugins": [],
  "stream_chat": "ah_openrouter__anthropic/claude-sonnet-4"
}